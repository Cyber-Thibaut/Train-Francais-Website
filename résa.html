<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="theme-color" content="#ff0000" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="img/logo/franceavenir.png" />
<meta name="twitter:title" content="France Avenir" />
<meta name="twitter:description" content="France Avenir, un groupe tourné vers l'avenir" />
<meta name="twitter:image" content="img/logo/franceavenir.png" />
<meta property="og:type" content="object" />
<meta property="og:url" content="https://train-francais.vercel.app" />
<meta property="og:title" content="France Avenir" />
<meta property="og:description" content="France Avenir, un groupe tourné vers l'avenir" />
<meta property="og:image" content="img/logo/franceavenir.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="600" />
<meta name="description" content="France Avenir, un groupe tourné vers l'avenir">
<meta name="author" content="">
<link rel="shortcut icon" href="img/logo/franceavenir.png" type="">

<title>France Avenir</title>
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,400italic,700,700italic,900,900italic,500italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <!-- Web Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic' rel='stylesheet' type='text/css'>
    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Flaticon CSS -->
    <link href="fonts/flaticon/flaticon.css" rel="stylesheet">
    <!-- font-awesome CSS -->
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <!-- Offcanvas CSS -->
    <link href="css/hippo-off-canvas.css" rel="stylesheet">
    <!-- animate CSS -->
    <link href="css/animate.css" rel="stylesheet">
    <!-- language CSS -->
    <link href="css/language-select.css" rel="stylesheet">
    <!-- owl.carousel CSS -->
    <link href="owl.carousel/assets/owl.carousel.css" rel="stylesheet">
    <!-- magnific-popup -->
    <link href="css/magnific-popup.css" rel="stylesheet">
    <!-- Main menu -->
    <link href="css/menu.css" rel="stylesheet">
    <!-- Template Common Styles -->
    <link href="css/template.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">
    <!-- Responsive CSS -->
    <link href="css/responsive.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script src="js/vendor/modernizr-2.8.1.min.js"></script>
    <style>
        .train-container {
    display: flex;
    flex-direction: row;
}

.train-info {
    flex: 1;
}

.train-prices {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-left: 10px;
}

.train-price {
    width: 200px;
    height: 100px;
    padding: 10px;
    border: 1px solid black;
}

.tag-important {
    background-color: #f44336; /* rouge */
    color: #fff; /* blanc */
    border-radius: 3px;
    padding: 2px 4px;
    font-size: 12px;
    margin-left: 10px;
}

.tag-info {
    background-color: #2196f3; /* bleu */
    color: #fff; /* blanc */
    border-radius: 3px;
    padding: 2px 4px;
    font-size: 12px;
    margin-left: 10px;
}
    </style>
</head>
<body id="page-top">
<div id="st-container" class="st-container">
        <div class="st-content">
                <header class="header">		 
<div id="st-container" class="st-container">
    <div class="st-pusher">
        <div class="st-content">
                <header class="header">
                    <nav class="top-bar">
                        <div class="overlay-bg">
                            <div class="container">
                                <div class="row">
                                    <div class="col-sm-6 col-xs-12">
                                        <div class="call-to-action">
                                            <ul class="list-inline">
                                            <li><a href="mailto:train-francais@protonmail.com"><i class="fa fa-envelope"></i>train-francais@protonmail.com</span></a></li>
                                            </ul>
                                        </div><!-- /.call-to-action -->
                                    </div><!-- /.col-sm-6 -->
                    <center><a href="index.html"><img id="logo" src="img/logo.png" width="20%" height="20%"></a></center>
                    <nav class="navbar navbar-default" role="navigation">
						<button type="button" class="navbar-toggle collapsed" >
							<span class="sr-only">Toggle navigation</span>
							<i class="fa fa-bars"></i>
							</button>
							<div class="collapse navbar-collapse navbar-collapse">
							<ul class="nav navbar-nav hidden-sm">
							<!-- <ul class="nav navbar-nav navbar-right"> -->
											<!-- Home -->
											<li><a href="index.html">Home</a></li>
											<!-- /Home -->

											<!-- Pages -->
											<li class="dropdown"><a href="#">France Avenir <span class="fa fa-angle-down"></span></a>
													<!-- submenu-wrapper -->
													<div class="submenu-wrapper submenu-wrapper-topbottom">
														<div class="submenu-inner  submenu-inner-topbottom">
															<ul class="dropdown-menu">
																<li><a href="about.html">About</a></li>
																<li><a href="livrées.html">Nos livrées</a></li>
																<li><a href="infotrafic.html">Information Trafic</a></li>
															</ul>
														</div>
													</div>
													<!-- /submenu-wrapper -->
											</li>
											<!-- /Pages -->
											<li class="dropdown"><a href="#">Ski Français <span class="fa fa-angle-down"></span></a>
												<!-- submenu-wrapper -->
												<div class="submenu-wrapper submenu-wrapper-topbottom">
													<div class="submenu-inner  submenu-inner-topbottom">
														<ul class="dropdown-menu">
															<li><a href="ski.html">Notre Station</a></li>
														</ul>
													</div>
												</div>
												<!-- /submenu-wrapper -->
										</li>
											<!-- Services -->
											<li class="dropdown"><a href="#">Transport Clermont Métropole <span class="fa fa-angle-down"></span></a>
									<!-- submenu-wrapper -->
									<div class="submenu-wrapper submenu-wrapper-topbottom">
									<div class="submenu-inner  submenu-inner-topbottom">
										<ul class="dropdown-menu">
											<li><a href="actubf.html">Actu</a></li>
											<li><a href="inventaire bus.html">Notre Inventaire</a></li>
											<li><a href="infotrafic.html">Information Trafic</a></li>
											<li><a href="agences.html"><img src="img/logo/info.png" alt="Gare Centrale <> Campus Cézeaux" width="10%" height="10%">Nos agences <span class="tag tag-info">NOUVEAU !</span></a></li>
											<li><a href="tarifsbus.html"><img src="img/logo/tarifs.png" alt="Gare Centrale <> Campus Cézeaux" width="10%" height="10%">Nos Tarifs <span class="tag tag-important">MISE A JOUR !</span></a></li>
											<li class="dropdown-header"><a><---  Info sur nos lignes urbaines ---></a>
												<li overflow: hidden; text-overflow: ellipsis; white-space: nowrap;>
												<a href="1.html">
													<img src="img/logo/1.png" alt="Gare Centrale <> Campus Cézeaux" width="10%" max-height="10%">
													Gare Centrale <> Campus Cézeaux
												</a></li>
												<li>
												<a href="2.html">
													<img src="img/logo/2.png" alt="Gare Centrale <> Aéroport" width="10%" height="10%">
													Gare Centrale <> Aéroport
												</a>
												</li>
												<li overflow: hidden; text-overflow: ellipsis; white-space: nowrap;>
												<a href="3.html">
													<img src="img/logo/3.png" alt="Gare Centrale <> Campus Marthe Gautier" width="10%" height="10%">
													Gare Centrale <> Campus Marthe Gautier
												</a>
												</li>
												<li>
												<a href="4.html">
													<img src="img/logo/4.png" alt="Gare Centrale <> Gare de l'Est" width="10%" height="10%">
													Gare Centrale <> Gare de l'Est
												</a>
												</li>
												<li>
												<a href="5.html">
													<img src="img/logo/5.png" alt="Musée d'Art Moderne <> Pôle Luca Pacioli" width="10%" height="10%">
													Musée d'Art Moderne <> Pôle Luca Pacioli
												</a>
												</li> 
												<li>
												<a href="6.html">
													<img src="img/logo/6.png" alt="Grand Palais <> Campus Maryse Esterle" width="10%" height="10%">
													Grand Palais <> Campus Maryse Esterle
												</a>
												</li> 
												<li>
												<a href="7.html">
													<img src="img/logo/7.png" alt="Port fluvial <> Grand Palais" width="10%" height="10%">
													Port fluvial <> Grand Palais
												</a>
												</li>
											</li>          
										</ul>
									</div>
									</div>
									<!-- /submenu-wrapper -->
								</li>
											<li class="dropdown"><a href="#">Train Français - Informations Pratiques <b class="caret"></b></a>
												<!-- submenu-wrapper -->
												<div class="submenu-wrapper submenu-wrapper-topbottom">
													<div class="submenu-inner  submenu-inner-topbottom">
														<ul class="dropdown-menu">
															<li><a href="plan.html">Plan de nos lignes</a></li>
															<li><a href="inventaire.html">Notre Inventaire</a></li>
															<li><a href="infotrafic.html">Information Trafic</a></li>
															<li><a href="résa.html">Réserver un billet</a></li>
															<li><a href="faq.html">FAQ</a></li>
														</ul>
													</div>
												</div>
												<!-- /submenu-wrapper -->
											</li>
											<li class="dropdown"><a href="#">Train Français - Informations Sur nos Lignes <b class="caret"></b></a>
												<!-- submenu-wrapper -->
												<div class="submenu-wrapper submenu-wrapper-topbottom">
													<div class="submenu-inner  submenu-inner-topbottom">
														<ul class="dropdown-menu">
															<li><a href="fgv.html"><i class="fas fa-train"></i> France à Grande Vitesse</a></li>
															<li><a href="ICE.html"><i class="fas fa-train"></i> ICEurope</a></li>
															<li><a href="ICSuisse.html"><i class="fas fa-train"></i> ICSuisse</a></li>
															<li><a href="région.html"><i class="fas fa-train"></i> France Région</a></li>
															<li><a href="tel.html"><i class="fas fa-train"></i> Train Express Lyonnais</a></li>
															<li><a href="tfm.html"><i class="fas fa-pallet"></i> Train Français Marchandise</a></li>
														</ul>
													</div>
												</div>
												<!-- /submenu-wrapper -->
											</li>
											<li><a href="départ.html">Train Français - Au départ de nos gares</a></li>
											<li><a href="franceavenir.html">France Avenir, l'alliance <span class="tag tag-info">NOUVEAU !</span></a></li>	
										</ul>
									</div><!-- /.navbar-collapse -->
							</nav>
						</div><!-- /.container -->
					</nav>
        </header>

        <section class="page-title-section">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="page-header-wrap">
                            <div class="page-header">
                                    <h1>Réserver son billet de Train</h1>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

<body>
<br>
<div class="container">
    <div class="row">
        <div class="col-md-12">
            
            <div class="col-md-6">
                <h4>Liste des gares</h4>
            <div class="col-md-6">
                <input type="text" class="form-control" id="searchInput" onkeyup="filterFunction()"
                    placeholder="Rechercher">
            </div>
            <div class="col-md-6">
                <select id="selectBox1" class="form-control">
                    <option disabled selected value>Choisissez la gare de départ</option>
                </select>
            </div></div>
            
            <div class="col-md-6">
                <h4>Destinations possibles</h4>
                <select id="selectBox2" class="form-control">
                    <option value="" disabled selected>Sélectionnez une destination</option>
                </select>
            </div>

        </div>
    </div>
</div>
<br>
<div class="container">
    <div class="row">
        <p></p>
        <div class="col-md-12">
            <div class="col-md-6">
            <select id="trainTypeFilter" class="form-control">
                <option value="all">Tous</option>
                <option value="v">Voyageurs</option>
                <option value="f">Fret</option>
            </select>
            </div>
            <div class="col-md-6">
            <center><button onclick="search()" type="button" class="btn btn-success">Rechercher</button></center>
            </div>
        </div>
        </div>
        <br />
        <div class="container">
            <div id="loading" style="display: none;">Chargement... 🚆🚆</div>
            <div id="results"></div>

    <div id="ticketModal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Entrez vos informations</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="name">Nom Prénom</label>
                            <input type="text" class="form-control" id="name">
                        </div>
                        <div class="form-group">
                            <label for="dob">Date de naissance</label>
                            <input type="date" class="form-control" id="dob">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Fermer - Retour</button>
                    <button type="button" class="btn btn-primary" id="generateTicket"
                        onclick='generateTicket()'>Acheter la place</button>
                </div>
            </div>
        </div>
    </div>
</body>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"
integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
</script>
<script>

function filterFunction() {
    const input = document.getElementById("searchInput");
    const filter = input.value.toUpperCase();
    const select = document.getElementById("selectBox1");
    const option = select.getElementsByTagName("option");
    for (var i = 0; i < option.length; i++) {
        const txtValue = option[i].textContent || option[i].innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
            option[i].style.display = "";
        } else {
            option[i].style.display = "none";
        }
    }
}

function init() {
    fetch('https://train-empire.com/api/getCompanyStations.php?auth=4ef1191fcad3fd8fca595469626f5f6c796f6e')
        .then(response => response.json())
        .then(data => {
            var selectBox1 = document.getElementById("selectBox1");
            var optgroup = null;
            Object.entries(data).forEach(function ([pays, stations]) {
                optgroup = document.createElement("optgroup");
                optgroup.label = pays;
                stations.forEach(function (station) {
                    var option = document.createElement("option");
                    option.text = station.name;
                    option.value = station.id;
                    optgroup.appendChild(option);
                });
                selectBox1.appendChild(optgroup);
            });
        });

    const selectBox1 = document.getElementById("selectBox1");
    const selectBox2 = document.getElementById("selectBox2");
    selectBox1.addEventListener("change", function () {
        selectBox2.innerHTML = "";
        var from = this.value;
        fetch('https://train-empire.com/api/getCompanyDestinations.php?auth=4ef1191fcad3fd8fca595469626f5f6c796f6e&from=' + from)
            .then(response => response.json())
            .then(data => {
                var optgroup = null;
                Object.entries(data).forEach(function ([pays, stations]) {
                    optgroup = document.createElement("optgroup");
                    optgroup.label = pays;
                    stations.forEach(function (station) {
                        var option = document.createElement("option");
                        option.text = station.name;
                        option.value = station.id;
                        optgroup.appendChild(option);
                    });
                    selectBox2.appendChild(optgroup);
                });
            });
    });
}

function search() {
    const auth = "4ef1191fcad3fd8fca595469626f5f6c796f6e";
    const from = document.getElementById("selectBox1").value;
    const destination = document.getElementById("selectBox2").value;
    const trainTypeFilter = document.getElementById("trainTypeFilter").value;

    const loading = document.getElementById("loading");

    loading.style.display = "block";

    fetch(`https://train-empire.com/api/getFromToStations.php?auth=${auth}&origin=${from}&endPoint=${destination}&limit=10`)
        .then(response => response.json())
        .then(data => {
            // Chargé !
            loading.style.display = "none";
            LIST = data;
            let i = 0;
            let html = '';
            data.forEach((train) => {
                
                if (trainTypeFilter === "all") {
                    if (train.type === "f") {
                        html += `<div class='container'>
                            <div class='col-md-12 train-container'>
                                <div class='train-info'>
                                    <h4><strong>Depuis:</strong> ${train.from} <strong>A destination de:</strong> ${train.to}</h4>
                                    <h5><strong>Intermédiaire:</strong> ${train.intermediate.replace(';', ', ')}</h5>
                                    <p><strong>Numéro de train:</strong> ${train.name} <strong>Service:</strong> ${train.service}</p>
                                    <p><strong>Heure de départ:</strong> ${train.departure} <strong>Heure d'arrivée:</strong> ${train.arrival}
                                    </p>
                                    <p><strong>Rame:</strong> ${train.trainset}</p>
                                </div>
                                <div class='train-prices'>
                                    <div class='train-price-first alert alert-info'>
                                    <h4>Ce train ne prends pas de passagers,<br>train de marchandise, <br>pour un tarif nous contacter.</h4>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                    </br>`;
                } else if (train.type === "v"){
                    html += `<div class='container'>
                        <div class='col-md-12 train-container'>
                            <div class='train-info'>
                                <h4><strong>Depuis:</strong> ${train.from} <strong>A destination de:</strong> ${train.to}</h4>
                                <h5><strong>Intermédiaire:</strong> ${train.intermediate.replace(';', ', ')}</h5>
                                <p><strong>Numéro de train:</strong> ${train.name} <strong>Service:</strong> ${train.service}</p>
                                <p><strong>Heure de départ:</strong> ${train.departure} <strong>Heure d'arrivée:</strong> ${train.arrival}
                                </p>
                                <p><strong>Rame:</strong> ${train.trainset}</p>
                            </div>
                            <div class='train-prices'>
                                <div class='train-price-first alert alert-danger'>
                                    <h4><strong>1ère Classe:</strong> ${train.price1}€</h4>
                                    <center><button type='button' class='btn btn-primary first-class train-button' data-toggle='modal'
                                        data-target='#ticketModal' onclick='ticketSelect(${i}, "1")'>Prendre ce billet</button></center>
                                </div>
                                <div class='train-price-second alert alert-success'>
                                    <h4><strong>2nde Classe:</strong> ${train.price2}€</h4>
                                    <center><button type='button' class='btn btn-primary secon-class train-button' data-toggle='modal'
                                        data-target='#ticketModal' onclick='ticketSelect(${i}, "2")'>Prendre ce billet</button></center>
                                </div>
                            </div>
                        </div>
                    </div>
                </br>`;
                }
                } else if (train.type === "f" && trainTypeFilter === "f") {
                    html += `<div class='container'>
                            <div class='col-md-12 train-container'>
                                <div class='train-info'>
                                    <h4><strong>Depuis:</strong> ${train.from} <strong>A destination de:</strong> ${train.to}</h4>
                                    <h5><strong>Intermédiaire:</strong> ${train.intermediate.replace(';', ', ')}</h5>
                                    <p><strong>Numéro de train:</strong> ${train.name} <strong>Service:</strong> ${train.service}</p>
                                    <p><strong>Heure de départ:</strong> ${train.departure} <strong>Heure d'arrivée:</strong> ${train.arrival}
                                    </p>
                                    <p><strong>Rame:</strong> ${train.trainset}</p>
                                </div>
                                <div class='train-prices'>
                                <div class='train-price-first alert alert-info'>
                                    <h4>Ce train ne prends pas de passagers,<br>train de marchandise, <br>pour un tarif nous contacter.</h4>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                    </br>`;
                } else if (trainTypeFilter === "v" && train.type === trainTypeFilter) {
                    html += `<div class='container'>
                        <div class='col-md-12 train-container'>
                            <div class='train-info'>
                                <h4><strong>Depuis:</strong> ${train.from} <strong>A destination de:</strong> ${train.to}</h4>
                                <h5><strong>Intermédiaire:</strong> ${train.intermediate.replace(';', ', ')}</h5>
                                <p><strong>Numéro de train:</strong> ${train.name} <strong>Service:</strong> ${train.service}</p>
                                <p><strong>Heure de départ:</strong> ${train.departure} <strong>Heure d'arrivée:</strong> ${train.arrival}
                                </p>
                                <p><strong>Rame:</strong> ${train.trainset}</p>
                            </div>
                            <div class='train-prices'>
                                <div class='train-price-first alert alert-danger'>
                                    <h4><strong>1ère Classe:</strong> ${train.price1}€</h4>
                                    <center><button type='button' class='btn btn-primary first-class train-button' data-toggle='modal'
                                        data-target='#ticketModal' onclick='ticketSelect(${i}, "1")'>Prendre ce billet</button></center>
                                </div>
                                <div class='train-price-second alert alert-success'>
                                    <h4><strong>2nde Classe:</strong> ${train.price2}€</h4>
                                    <center><button type='button' class='btn btn-primary secon-class train-button' data-toggle='modal'
                                        data-target='#ticketModal' onclick='ticketSelect(${i}, "2")'>Prendre ce billet</button></center>
                                </div>
                            </div>
                        </div>
                    </div>
                </br>`;
                i++;
            }
                document.getElementById("results").innerHTML = html;
            });

        });
}

function ticketSelect(innerID, service) {
    console.log({ innerID, service });
    SERVICE = service;
    ID = innerID;
}


function generateTicket() {
    const pdf = new jsPDF();

    // Changer la police et la taille du texte
    pdf.setFont('helvetica');
    pdf.setFontSize(12);

    pdf.setTextColor(0, 0, 0);
    pdf.setFillColor(220, 220, 220);

    var reference = '';
    var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    for (var i = 0; i < 6; i++) {
        reference += possible.charAt(Math.floor(Math.random() * possible.length));
    }
    const name = document.getElementById('name').value;
    const dob = document.getElementById('dob').value;
    const selectedClass = SERVICE;

    pdf.rect(10, 10, 190, 250);
    // pdf.rect(10, 10, 190, 50);
    // pdf.rect(10, 50, 90, 100);
    pdf.rect(100, 50, 100, 190);
    // pdf.rect(10, 170, 190, 50);
    // pdf.rect(10, 220, 190, 50);
    
    pdf.text(20, 20, 'Voici le récapitulatif de votre billet :');
    pdf.text(20, 30, 'Nom : ' + name);
    pdf.text(120, 30, 'Date de naissance : ' + dob);
    pdf.text(20, 40, 'Classe : ' + selectedClass);
    pdf.text(120, 40, 'REF : ' + reference);

    const trainInfo = LIST[ID];


    var from = trainInfo['from'];
    var to = trainInfo['to']
    var intermediate = trainInfo['intermediate']
    var nametrain = trainInfo['name']
    var service = trainInfo['service']
    var departure = trainInfo['departure']
    var arrival = trainInfo['arrival']
    var stoptrain = trainInfo['intermediate'].split(';')
    var trainset = trainInfo['trainset']
    var price = selectedClass == "1" ? trainInfo['price1'] : trainInfo['price2'];

    const start = trainInfo['from'];
    const end = trainInfo['to'];
    const allStops = [start].concat(stoptrain).concat([end]);
    
    pdf.text(20, 60, 'Depuis : ' + from);
    pdf.text(20, 70, 'Destination : ' + to);
    pdf.text(20, 90, 'Nom du train : ' + nametrain);
    pdf.text(20, 100, 'Service : ' + service);
    pdf.text(20, 110, 'Départ : ' + departure);
    pdf.text(20, 120, 'Arrivée : ' + arrival);
    pdf.text(20, 130, 'Composition du train : ' + trainset);
    pdf.text(20, 140, 'Prix : ' + price + '€');

    // Dessiner le trajet du train et les arrêts intermédiaires
    // Calcul de la hauteur de la zone de dessin
    const height = 15 + (allStops.length + 1) * 15;

    // Dessin de la ligne reliant les arrêts intermédiaires
    pdf.setDrawColor(0, 51, 102);
    pdf.setLineWidth(0.5);
    const lineX = 180;
    const lineY1 = 60;
    const lineY2 = lineY1 + (allStops.length * 15);
    pdf.line(lineX, lineY1, lineX, lineY2);

    // Dessin des points pour les arrêts intermédiaires
    pdf.setFillColor(0, 51, 102);
    const radius = 3;
    for (let i = 0; i < allStops.length; i++) {
    if (allStops[i] !== "direct") {
        const pointX = lineX;
        const pointY = lineY1 + ((i + 1) * 15) - radius;
        pdf.circle(pointX, pointY, radius, 'F');
    }
    }

    // Dessin des noms des arrêts intermédiaires
    pdf.setTextColor(0, 0, 0);
    pdf.setFontSize(10);
    for (let i = 0; i < allStops.length; i++) {
    const textX = lineX - 5;
    const textY = lineY1 + ((i + 1) * 15) - radius + 1;
    if (i === 0 || i === allStops.length - 1) {
        pdf.setFontType("bold");
        pdf.setTextColor(0, 102, 204);
    }
    pdf.text(allStops[i], textX, textY, { align: 'right' });
    pdf.setFontType("normal");
    pdf.setTextColor(0, 0, 0);
    }

    pdf.save('billet.pdf');
    location.reload()
}

$(document).ready(function () {
    // Show modal and set the selected class value when first-class or second-class button is clicked
    $('.first-class').click(function () {
        $('#ticketModal').modal('show');
        $('#selectedClass').val('first-class');
    });
    $('.second-class').click(function () {
        $('#ticketModal').modal('show');
        $('#selectedClass').val('second-class');
    });

    var trainInfo;
    $('.train-button').click(function () {
        trainInfo = $(this).parent().parent().find('.train-info');
    });
});

init();
ID = null;
SERVICE = null;
LIST = [];
</script>

<!-- footer-widget-section start -->
<section class="footer-widget-section section-padding">
<div class="container">
    <div class="row">
        <div class="col-md-3 col-md-offset-1 col-sm-4">
            <div class="footer-widget">
                <h3>Place &amp; Contact</h3>

                <address>
                    14, cours de Verdun<br>
                    69002 Lyon<br>

                    <!-- Google Map Modal Trigger -->
                    <button type="button" class="modal-map" data-toggle="modal" data-target="#cssMapModal">Location  Map</button>
                </address>


                <!-- Modal -->
                <div class="modal fade" id="cssMapModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Our Location</h4>
                        </div>
                        <div class="modal-body">

                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2784.1303794465844!2d4.8236481159683695!3d45.74853207910533!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47f4ebb4c09ab051%3A0x32e14f503a1b4769!2sLyon%20Perrache!5e0!3m2!1sfr!2sfr!4v1645624274490!5m2!1sfr!2sfr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>

                        </div>
                    </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- End Modal -->
            </div><!-- /.footer-widget -->
        </div><!-- /.col-md-4 -->

        <div class="col-md-3 col-sm-4">

            <div class="footer-widget">
                <h3>About Transport</h3>

                <ul>
                    <li><a href="about.html">About</a></li>
                    <li><a href="faq.html">FAQ Page</a></li>
                </ul>
            </div><!-- /.footer-widget -->
        </div><!-- /.col-md-4 -->
    <div class="col-md-3 col-sm-5">
        <a class="twitter-timeline" data-lang="fr" data-height="300" href="https://twitter.com/FrancaisTrain?ref_src=twsrc%5Etfw">Tweets by FrancaisTrain</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 
    </div>
    </div><!-- /.row -->
</div><!-- /.container -->
</section><!-- /.cta-section -->
<!-- footer-widget-section end -->

<!-- copyright-section start -->
<footer class="copyright-section">
<div class="container text-center">
    <div class="copyright-info">
        <span>Copyright &copy; 2020-<script>document.write(new Date().getFullYear());</script> All rights reserved | Ce site a été fait avec ❤️ par Thibaut pour <a href="Index.html" target="_blank">le groupe France Avenir</a><h1 class="logo"><img src="img/logo/franceavenir.png" alt=""></a></h1>
    </div>
</div><!-- /.container -->
</footer>
<!-- copyright-section end -->
</div> <!-- .st-content -->
</div> <!-- .st-pusher -->

<!-- OFF CANVAS MENU -->
<div class="offcanvas-menu offcanvas-effect">
<div class="offcanvas-wrap">
    <div class="off-canvas-header">
        <button type="button" class="close" aria-hidden="true" data-toggle="offcanvas" id="off-canvas-close-btn">&times;</button>
    </div>
<a><img src="img/logo/franceavenir.png" alt=""></a>	
<ul id ="offcanvasMenu" class="list-unstyled visible-xs visible-sm">
    <li class="active"><a href="index.html">Home<span class="sr-only">(current)</span></a></li>
    <li>
        <a href="#">France Avenir</a>
        <ul>
            <li><a href="about.html">About</a></li>
<li><a href="livrées.html">Nos livrées</a></li>
<li><a href="infotrafic.html">Information Trafic</a></li>
        </ul>

    </li>
    <li><a href="#">Ski Français</a>
        <ul>
            <li><a href="ski.html">Notre Station</a></li>
        </ul>
    </li>
<li><a href="#">Transport Clermont Métropole</a>
                    <ul>
                        <li><a href="actubf.html">Actu</a></li>
                                                                <li><a href="inventaire bus.html">Notre Inventaire</a></li>
                                                                <li><a href="infotrafic.html">Information Trafic</a></li>
                                                                <li><a href="agences.html">Nos agences <span class="tag tag-info">NOUVEAU !</span></a></li>
                                                                <li><a href="tarifsbus.html">Nos Tarifs <span class="tag tag-important">MISE A JOUR !</span></a></li>
                                                                <li class="dropdown-header"><a><---  Info sur nos lignes  ---></a></li>
                                                                <li overflow: hidden; text-overflow: ellipsis; white-space: nowrap;>
                                                                            <a href="1.html">
                                                                                <img src="img/logo/1.png" alt="Gare Centrale <> Campus Cézeaux" width="10%" max-height="10%">
                                                                                Gare Centrale <> Campus Cézeaux
                                                                            </a>
                                                                            </li>
                                                                            <li>
                                                                            <a href="2.html">
                                                                                <img src="img/logo/2.png" alt="Gare Centrale <> Aéroport" width="10%" height="10%">
                                                                                Gare Centrale <> Aéroport
                                                                            </a>
                                                                            </li>
                                                                            <li overflow: hidden; text-overflow: ellipsis; white-space: nowrap;>
                                                                            <a href="3.html">
                                                                                <img src="img/logo/3.png" alt="Gare Centrale <> Campus Marthe Gautier" width="10%" height="10%">
                                                                                Gare Centrale <> Campus Marthe Gautier
                                                                            </a>
                                                                            </li>
                                                                            <li>
                                                                            <a href="4.html">
                                                                                <img src="img/logo/4.png" alt="Gare Centrale <> Gare de l'Est" width="10%" height="10%">
                                                                                Gare Centrale <> Gare de l'Est
                                                                            </a>
                                                                            </li>
                                                                            <li>
                                                                            <a href="5.html">
                                                                                <img src="img/logo/5.png" alt="Musée d'Art Moderne <> Pôle Luca Pacioli" width="10%" height="10%">
                                                                                Musée d'Art Moderne <> Pôle Luca Pacioli
                                                                            </a>
                                                                            </li> 
                                                                            <li>
                                                                            <a href="6.html">
                                                                                <img src="img/logo/6.png" alt="Grand Palais <> Campus Maryse Esterle" width="10%" height="10%">
                                                                                Grand Palais <> Campus Maryse Esterle
                                                                            </a>
                                                                            </li> 
                                                                            <li>
                                                                            <a href="7.html">
                                                                                <img src="img/logo/7.png" alt="Port fluvial <> Grand Palais" width="10%" height="10%">
                                                                                Port fluvial <> Grand Palais
                                                                            </a>
                                                                            </li>                                          </li>
                    </ul>
                </li>
                <li><a href="#">Train Français - Information Pratiques</a>
                    <ul>
                        <li><a href="plan.html">Plan de nos lignes</a></li>
                        <li><a href="inventaire.html">Notre Inventaire</a></li>
                        <li><a href="infotrafic.html">Information Trafic</a></li>
                        <li><a href="résa.html">Réserver un billet</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                    </ul>
                </li>
                <li><a href="#">Train Français - Au départ de nos gares</a>
                    <ul>
                        <li><a href="départ.html#LP">Lyon Perrache</a></li>
                                                            <li><a href="départ.html#bsj">Bordeaux St-Jean</a></li>
                                                            <li><a href="départ.html#PGL">Paris Gare de Lyon</a></li>
                                                            <li><a href="départ.html#TPN">Torino Porto Nova</a></li>
                                                            <li><a href="départ.html#tm">Toulouse Matabiau</a></li>
                                                            <li><a href="départ.html#CF">Clermont-Ferrand <span class="tag tag-info">NOUVEAU !</span></a></li>
                    </ul>
                </li>
                <li><a href="#">Informations sur nos lignes</a>
                    <ul>
                        <li><a href="fgv.html"><i class="fas fa-train"></i> France à Grande Vitesse</a></li>
                                                            <li><a href="ICE.html"><i class="fas fa-train"></i> ICEurope</a></li>
                                                            <li><a href="ICSuisse.html"><i class="fas fa-train"></i> ICSuisse</a></li>
                                                            <li><a href="région.html"><i class="fas fa-train"></i> France Région</a></li>
                                                            <li><a href="tel.html"><i class="fas fa-train"></i> Train Express Lyonnais</a></li>
                                                            <li><a href="tfm.html"><i class="fas fa-pallet"></i> Train Français Marchandise</a></li>
                    </ul>
                </li>
                <li><a href="franceavenir.html">France Avenir, l'alliance <span class="tag tag-info">NOUVEAU !</span></a></li>
</ul>
<div class="offcanvas-widgets hidden-sm hidden-xs">
    <div id="twitterWidget">
        <h2>Tweeter feed</h2>                       
        <div class="twitter-widget"><a class="twitter-timeline" data-lang="fr" data-height="300" href="https://twitter.com/FrancaisTrain?ref_src=twsrc%5Etfw">Tweets by FrancaisTrain</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div>
    </div>
    <div class="newsletter-widget">
        <h2>Stay in Touch</h2>
        <p>Enter your email address to receive news &amp; offers from us</p>

        <form class="newsletter-form">
            <div class="form-group">
                <label class="sr-only" for="InputEmail1">Email address</label>
                <input type="email" class="form-control" id="InputEmail2" placeholder="Your email address">
                <button type="submit" class="btn">Send &nbsp;<i class="fa fa-angle-right"></i></button>
            </div>
        </form>     
                            
    </div><!-- newsletter-widget -->
</div>

</div>
</div><!-- .offcanvas-menu -->
</div><!-- /st-container -->


<!-- Preloader -->
<div id="preloader">
<div id="status">
<div class="status-mes"></div>
</div>
</div>

<!-- jQuery -->
<script src="js/jquery.js"></script>
<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>
<!-- Scrolling Nav JavaScript -->
<script src="js/jquery.easing.min.js"></script>
<!-- owl.carousel -->
<script src="owl.carousel/owl.carousel.min.js"></script>
<!-- Magnific-popup -->
<script src="js/jquery.magnific-popup.min.js"></script>
<!-- Offcanvas Menu -->
<script src="js/hippo-offcanvas.js"></script>
<!-- stellar -->
<script src="js/jquery.stellar.js"></script>
<!-- classie -->
<script src="js/classie.js"></script>
<!-- selectFx -->
<script src="js/selectFx.js"></script>
<!-- sticky kit -->
<script src="js/jquery.sticky-kit.min.js"></script>
<!-- Twitter feed -->
<script src="js/twitterFetcher_min.js"></script>
<!-- Custom Script -->
<script src="js/scripts.js"></script>
</body>
</html>